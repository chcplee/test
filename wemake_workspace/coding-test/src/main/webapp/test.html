<!DOCTYPE html>
<html>
<head>

<style>
	#frmDiv{
		text-align:center;
		margin-bottom:15px;
	}
	#frmTbl{
		width: 500px;
		border-top: 2px solid rgb(222,221,226);
		border-bottom: 2px solid rgb(222,221,226);
		border-left:0px;
		border-right:0px;
		border-spacing: 0px;
		display: inline-block;
	}
	#frmTbl th{
		width: 150px;
		height: 35px;
		padding: 0px;
		margin: 0px;
		border-right : 1px solid rgb(222,221,226);
		border-bottom : 1px solid rgb(222,221,226);
		background-color : #f0f0f1;
		font-size: 10pt;
		font-weight: bold;
	}
	#frmTbl th:last-child{
		border-bottom : none;
	}
	#frmTbl td{
		width: 350px;
		padding: 0px;
		margin: 0px;
		border-bottom : 1px solid rgb(222,221,226);
	}
	.al{
		text-align:left;
	}
</style>
<script type="text/javascript">

function initTab(){
	$('#tabDiv > button').click(function(e){
		if(!$(this).hasClass('on')){
			$('#tabDiv > button').removeClass('on');
			$(this).addClass('on');
			if(e.target.id == 'histBtn'){
				location.href = '${ctx}/gateway/acnm/server/priority/works';
			}else if(e.target.id == 'listBtn'){
				location.href = '${ctx}/gateway/acnm/server/priority';
			}
		}
	});
}

function initModal(){
	var modal = document.getElementById("modalReason");
	var btn = document.getElementById("pgSubmitBtn");
	var span = document.getElementsByClassName("close")[0];
	var cancel = document.getElementById("cancel");
	var submit = document.getElementById("submit");
	btn.onclick = function(){
		modal.style.display = "block";
	}
	cancel.onclick = function(){
		modal.style.display = "none";
	}
	span.onclick = function(){
		modal.style.display = "none";
	}
	window.onclick = function(event){
		if(event.target == modal){
			modal.style.display = "none";
		}
	}
	//적용
	submit.onclick = function(){
		var reason = document.getElementById("reason");
		if(reason == null || reason.value == ""){
			alert('사유를 입력하세요.');
			reason.focus();
			return;
		}
		if(reason.value.length > 200){
			alert('200자 이내로 입력하세요');
			reason.focus();
			return;
		}
		var gatewayArr = [];
		var noEmpInput = '2031171'; //#수정 포인트
		for(var i in gateway){
			var cdGw = gateway[i];
			var cdGw2 = $('tr[cdGw="'+cdGw+'"]').find('select[name="cdGw2"]').val();
			var cdGw3 = $('tr[cdGw="'+cdGw+'"]').find('select[name="cdGw3"]').val();
			gatewayArr.push({
				'clPaymethod' : '<c:out value="${NetManagerConst.PAYMETHOD_ACNM}"/>',
				'cdGw' : cdGw,
				'cdGw2' : cdGw2,
				'cdGw3' : cdGw3,
				'noEmpInput' : noEmpInput,
				'clReason' : reason.value,
				'cdStatus' : '0', // -- AS-IS에 따름
				'clMode' : '0'	  // -- AS-IS에 따름
			});
		}
		var url = '${ctx}/gateway/api/acnm/server/priority';
		$.ajax({
			url:url,
			type:'PUT',
			contentType:'application/json; charset=EUC-KR',
			data:JSON.stringify(gatewayArr),
			dataType:'JSON',
			async:false,
			success: function(data, textStatus, jqXHR){
				if(jqXHR.status == '<c:out value="${HttpStatus.OK}"/>'){
					alert('네트워크 우선순위 변경에 성공하였습니다.');
					location.reload();
				}else{
					alert('네트워크 우선순위 변경에 실패하였습니다.');
				}
			}, error: function(xhr, ajaxOptions, thrownError){
				var responseJSON = xhr.responseJSON;
				alert(responseJSON.message+'{status-code :'+xhr.status+', status : '+responseJSON.status+', message : '+responseJSON.debugMessage+'}');
			}
		})
	}
}

function getGatewayPriority(){
	var url = '${ctx}/gateway/api/acnm/server/priority';
	$.get(url,{},function(list){
		for(var i in list){
			var data = list[i];
			var cdGw2 = $('tr[cdGw="'+data.cdGw+'"]').find('select[name="cdGw2"]').find('option[value="'+data.cdGw2+'"]');
			if(cdGw2 != null){
				cdGw2.attr('selected','selected');
			}
			var cdGw3 = $('tr[cdGw="'+data.cdGw+'"]').find('select[name="cdGw3"]').find('option[value="'+data.cdGw3+'"]');
			if(cdGw3 != null){
				cdGw3.attr('selected','selected');
			}
		}
	},'json');
}

function addChgGw(select){
	var cdGw = $(select).parent().parent().attr('cdGw');
	if(gateway[cdGw] == null){
		gateway[cdGw] = {};
	}
	gateway[cdGw] = cdGw;
	$(select).parent().parent().find('select').addClass('target');
}
</script>
<meta charset="EUC-KR">
<title>위메프 코딩 테스트</title>
</head>
<body>
<div id="frmDiv">
	<div>
	    <table id="frmTbl">
						<tr>
							<th><label>URL</label></th>
							<td><input type="text" name="url"></td>
						</tr>
						<tr>
							<th><label>Type</label></th>
							<td>
								<select id="parsingType">
									<option value="" selected disabled>타입 선택</option>
									<option id="htmlWithoutTag">Html 태그 제외</option>
									<option id="fullText">Text 전체</option>
								</select>
							</td>
						</tr>
						<tr>
							<th><label>출력 묶음</label></th>
							<td><input type="text" id="groupCount"></td>
						</tr>
		</table>
	    <button type="button" class="btn btn-default">출력</button>
    </div>
    <div id="outArea">
    	<div>
    	<label>몫 출력 </label>
    	<textarea name="quotient" rows="10" cols="30"></textarea>
    	</div>
    	<div>
    	<label>나머지 출력</label>
    	<textarea name="remainder" rows="10" cols="30"></textarea>
    	</div>
    </div>
</div>
</body>
</html>